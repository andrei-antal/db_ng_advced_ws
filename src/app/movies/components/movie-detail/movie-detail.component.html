<div class="card">
  <div class="card-header">Movie form</div>
  <div class="card-body">
    <div class="row">
      <form class="col-9" [formGroup]="movieForm" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="movieTitle">Title</label>
          <input
            name="title"
            class="form-control"
            id="movieTitle"
            placeholder="Enter title"
            formControlName="title"
          />
          <div
            class="invalid-feedback"
            *ngIf="
              movieForm.controls.title.invalid && movieForm.controls.title.dirty
            "
          >
            Title required
          </div>
        </div>
        <div class="form-group">
          <label for="movieGenre" class="d-block">Genre</label>
          <div
            formArrayName="genre"
            class="mb-2"
            *ngFor="let genreCtrl of genreArray.controls; index as i"
          >
            <select
              class="form-select w-50 d-inline me-2"
              [formControlName]="i"
            >
              <option disabled value="">Choose a new genre</option>
              <option *ngFor="let genre of genres" [ngValue]="genre">
                {{ genre }}
              </option>
            </select>
            <button
              class="btn btn-outline-secondary"
              (click)="removeGenre(i)"
              type="button"
            >
              <i class="fa-regular fa-circle-xmark"></i>
            </button>
          </div>
          <button
            class="btn btn-dark btn-sm"
            (click)="addGenre()"
            type="button"
          >
            Add genre
          </button>
          <div
            class="invalid-feedback"
            *ngIf="genreArray.errors?.['wrongGenre'] && genreArray.dirty"
          >
            Genre required
          </div>
          <div
            class="invalid-feedback"
            *ngIf="
              !movieForm.controls.genre.errors?.['required'] &&
              movieForm.controls.genre.errors?.['wrongGenre'] &&
              movieForm.controls.genre.dirty
            "
          >
            Not a genre category
          </div>
        </div>
        <div class="form-group">
          <label for="movieYear">Year</label>
          <input
            name="year"
            class="form-control"
            id="movieYear"
            placeholder="Enter year"
            formControlName="year"
          />
          <div
            class="invalid-feedback"
            *ngIf="
              movieForm.controls.year.invalid && movieForm.controls.year.dirty
            "
          >
            Year required
          </div>
        </div>
        <div class="form-group">
          <label for="moviePlot">Plot</label>
          <input
            name="plot"
            class="form-control"
            id="moviePlot"
            placeholder="Enter plot"
            formControlName="plot"
          />
          <div
            class="invalid-feedback"
            *ngIf="
              movieForm.controls.plot.invalid && movieForm.controls.plot.dirty
            "
          >
            Plot required
          </div>
        </div>
        <div class="form-group">
          <label for="moviePoster">Poster</label>
          <input
            name="poster"
            class="form-control"
            id="moviePoster"
            placeholder="Enter poster"
            formControlName="poster"
          />
        </div>
        <div class="my-2">
          <button
            type="submit"
            class="btn btn-primary"
            [disabled]="movieForm.invalid"
          >
            Save
          </button>
          <a [routerLink]="['/movies']" class="btn btn-outline-secondary mx-2"
            >Cancel</a
          >
        </div>
        <div
          class="invalid-feedback"
          *ngIf="movieForm.errors?.['wrongSciFiYear'] && movieForm.dirty"
        >
          Sci-Fi movies were introduced after 1902
        </div>
      </form>
      <div class="col-3">
        <img
          ngmMovieImageFallback
          class="w-100"
          [src]="movieForm.controls.poster.value"
        />
      </div>
    </div>
  </div>
</div>
